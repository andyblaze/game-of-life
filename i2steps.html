<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Penrose Tracer</title>
<style>
  body { margin:0; background:#111; color:#eee; font-family:monospace; }
  #report { position:fixed; right:0; top:0; bottom:0; width:240px; background:#222; overflow:auto; padding:10px; font-family:monospace; font-size:16px;}
  #c { display:block; background:#fff; }
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="report">[]</div>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const report = document.getElementById('report');
let vertices = [];

const bg = new Image();
bg.src = "ps.png"; // your local Penrose stairs image
bg.onload = () => draw();

function resize(){
  canvas.width = window.innerWidth - 240;
  canvas.height = window.innerHeight;
  draw();
}
window.addEventListener('resize', resize);
resize();

canvas.addEventListener('click', e=>{
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  vertices.push({x:Math.round(x), y:Math.round(y)});
  draw();
});

// Right-click = undo last point
canvas.addEventListener('contextmenu', e=>{
  e.preventDefault();
  vertices.pop();
  draw();
});

function drawGrid(spacing=10){
  ctx.strokeStyle="rgba(55,55,55,0.3)";
  ctx.lineWidth=1;
  for(let x=0;x<canvas.width;x+=spacing){
    ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke();
  }
  for(let y=0;y<canvas.height;y+=spacing){
    ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(bg.complete) ctx.drawImage(bg,0,0,canvas.width,canvas.height);
  drawGrid();
  
  if(vertices.length>0){
    ctx.strokeStyle="lime"; ctx.lineWidth=2;
    ctx.beginPath();
    vertices.forEach((v,i)=>{
      if(i===0) ctx.moveTo(v.x,v.y);
      else ctx.lineTo(v.x,v.y);
    });
    ctx.stroke();
    
    ctx.fillStyle="red";
    ctx.font="12px monospace";
    vertices.forEach((v,i)=>{
      ctx.beginPath();
      ctx.arc(v.x,v.y,4,0,Math.PI*2);
      ctx.fill();
      ctx.fillText(i,v.x+6,v.y-6);
    });
  }

  report.textContent = JSON.stringify(vertices,null,2);
}
</script>
</body>
</html>
