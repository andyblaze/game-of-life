<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KaleidoScope Simulator</title>
<style>
  body { margin:0; overflow:hidden; background:#000; }
  canvas { display:block; }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const slices = 12;                 // number of mirrored panels
const angle = (2 * Math.PI) / slices;
let t = 0;

// Create an offscreen canvas as the "source texture"
const src = document.createElement('canvas');
src.width = 800;
src.height = 800;
const sctx = src.getContext('2d');

// Draw or animate your texture here
function drawSource(time) {
  const w = src.width, h = src.height;
  sctx.fillStyle = 'black';
  sctx.fillRect(0, 0, w, h);
  for (let i = 0; i < 20; i++) {
    const x = (Math.sin(time*0.001 + i)*0.5 + 0.5)*w;
    const y = (Math.cos(time*0.0012 + i)*0.5 + 0.5)*h;
    const r = 50 + 40*Math.sin(time*0.002 + i);
    sctx.fillStyle = `hsl(${(i*30 + time*0.05)%360},80%,60%)`;
    sctx.beginPath();
    sctx.rect(x, y, 12, 12);
    sctx.fill();
  }
}

// Draw the kaleidoscope
function draw(time) {
  drawSource(time);
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  const radius = Math.min(canvas.width, canvas.height) / 2;
  ctx.save();
  ctx.translate(canvas.width/2, canvas.height/2);
  
  for (let i = 0; i < slices; i++) {
    ctx.save();
    ctx.rotate(i * angle);
    if (i % 2 === 0) ctx.scale(1, 1); // normal
    else ctx.scale(1, -1); // mirrored
    
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(radius*Math.tan(angle/2), radius);
    ctx.lineTo(-radius*Math.tan(angle/2), radius);
    ctx.closePath();
    ctx.clip();
    
    // Draw source pattern rotated slowly
    ctx.drawImage(src, -radius, -radius, radius*2, radius*2);
    ctx.restore();
  }
  
  ctx.restore();
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
