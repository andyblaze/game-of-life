<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Aurora Curtain â€“ Half Width + Soft Fade</title>
<style>
    body {
        margin: 0;
        background: #000;
        overflow: hidden;
    }
    canvas {
        display: block;
    }
</style>
</head>
<body>
<canvas id="c"></canvas>

<script>
// ------------------ CONFIG ------------------
const CURTAIN_WIDTH_FACTOR = 0.5; // <--- 0.5 = half width (change as you like)
const AURORA_HEIGHT = 20; // 100px thick glow area
const TOP_NOISE_SPEED = 0.00035;
const BOTTOM_NOISE_SPEED = 0.00029;
const DETAIL = 280; // number of sample points across the curtain

// --------------- Basic Canvas Setup ---------------
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let W, H;

function resize(){
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

// ------------------ Perlin Noise 2D -----------------
class PerlinNoise2D {
    constructor() {
        this.gradients = {};
        this.memory = {};
    }
    rand_vect() {
        let theta = Math.random() * 2 * Math.PI;
        return {x: Math.cos(theta), y: Math.sin(theta)};
    }
    dot_prod_grid(x, y, vx, vy) {
        let g;
        let d = this.gradients[[vx,vy]];
        if (!d) {
            d = this.rand_vect();
            this.gradients[[vx,vy]] = d;
        }
        return (x-vx)*d.x + (y-vy)*d.y;
    }
    smootherstep(x) {
        return 6*x**5 - 15*x**4 + 10*x**3;
    }
    interp(a, b, t) {
        return a + this.smootherstep(t) * (b-a);
    }
    get(x, y) {
        if (this.memory[[x,y]]) return this.memory[[x,y]];
        let xf = Math.floor(x), yf = Math.floor(y);
        let tl = this.dot_prod_grid(x, y, xf, yf);
        let tr = this.dot_prod_grid(x, y, xf+1, yf);
        let bl = this.dot_prod_grid(x, y, xf, yf+1);
        let br = this.dot_prod_grid(x, y, xf+1, yf+1);

        let xt = x - xf;
        let yt = y - yf;

        let xt0 = this.interp(tl, tr, xt);
        let xt1 = this.interp(bl, br, xt);

        return this.interp(xt0, xt1, yt);
    }
}
const noise = new PerlinNoise2D();

// ------------------ Aurora Render --------------------
function drawAurora(t){
    const cw = W * CURTAIN_WIDTH_FACTOR;   // actual curtain width
    const cx = (W - cw) * 0.5;             // centered X offset

    // Build top and bottom noisy lines
    let topPoints = [];
    let bottomPoints = [];

    for(let i=0;i<=DETAIL;i++){
        let x = cx + (i / DETAIL) * cw;

        let nTop = noise.get(i * 0.04, t * TOP_NOISE_SPEED);
        let nBot = noise.get(i * 0.06, t * BOTTOM_NOISE_SPEED);

        let topY = H/2 + nTop * 30;
        let bottomY = topY + AURORA_HEIGHT + nBot * 20;

        topPoints.push({x, y: topY});
        bottomPoints.push({x, y: bottomY});
    }

    // Draw filled aurora shape
    let auroraCanvas = document.createElement("canvas");
    let ac = auroraCanvas.getContext("2d");
    auroraCanvas.width = W;
    auroraCanvas.height = H;

    ac.beginPath();
    ac.moveTo(topPoints[0].x, topPoints[0].y);
    topPoints.forEach(p => 
        ac.lineTo(p.x, p.y)
    );
    bottomPoints.reverse().forEach(p => ac.lineTo(p.x, p.y));
    ac.closePath();

    // Neon-ish green fill
    let grad = ac.createLinearGradient(0, H/2, 0, H/2 + AURORA_HEIGHT);
    grad.addColorStop(0, "rgba(120,255,0,1)");
    grad.addColorStop(1, "rgba(30,240,0,0.7)");
    ac.fillStyle = grad;
    ac.fill();
    /*ac.strokeStyle = "rgba(120,255,0,1)";
    ac.lineWidth = 0.5;
    for( const p of topPoints ) { 
        ac.moveTo(p.x, p.y);
        ac.lineTo(p.x, 0);
        ac.stroke();
    }*/

    // ------------------ FADE LEFT & RIGHT EDGES ------------------
    /*ac.save();
    ac.globalCompositeOperation = "destination-in";

    let mask = ac.createLinearGradient(cx,0,cx+cw,0);
    mask.addColorStop(0, "rgba(0,0,0,0)");
    mask.addColorStop(0.12,"rgba(0,0,0,1)");
    mask.addColorStop(0.88,"rgba(0,0,0,1)");
    mask.addColorStop(1, "rgba(0,0,0,0)");

    ac.fillStyle = mask;
    ac.fillRect(cx,0,cw,H);
    ac.restore();*/

    // Draw final to main canvas
    ctx.drawImage(auroraCanvas,0,0);
}

// ------------------ LOOP ---------------------
function loop(t){
    ctx.clearRect(0,0,W,H);
    drawAurora(t);
    requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

</script>
</body>
</html>
