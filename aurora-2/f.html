<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Julia Set Zoom</title>
<style>
    body { margin:0; overflow:hidden; background:#000; }
    canvas { display:block; image-rendering: pixelated; }
</style>
</head>
<body>
<canvas id="c"></canvas>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;

// Internal low-res canvas for speed
let offCanvas = document.createElement('canvas');
let offCtx = offCanvas.getContext('2d');
offCanvas.width = Math.floor(W/2);
offCanvas.height = Math.floor(H/2);

let imageData = offCtx.createImageData(offCanvas.width, offCanvas.height);
let data = imageData.data;

// Julia parameters
let zoom = 1;
let offsetX = 0;
let offsetY = 0;
let cRe = -0.7;
let cIm = 0.27015;
let maxIter = 150;
let zoomFactor = 1.02;
let hueOffset = 0;

// Compute Julia
function julia(x, y){
    let zx = x;
    let zy = y;
    let iter = 0;
    while(zx*zx + zy*zy < 4 && iter < maxIter){
        let xt = zx*zx - zy*zy + cRe;
        zy = 2*zx*zy + cIm;
        zx = xt;
        iter++;
    }
    return iter;
}

// HSV to RGB helper
function hsvToRgb(h,s,v){
    let c = v*s;
    let hp = h/60;
    let x = c*(1-Math.abs(hp%2 -1));
    let r=0,g=0,b=0;
    if(hp>=0 && hp<1){r=c; g=x; b=0;}
    else if(hp>=1 && hp<2){r=x; g=c; b=0;}
    else if(hp>=2 && hp<3){r=0; g=c; b=x;}
    else if(hp>=3 && hp<4){r=0; g=x; b=c;}
    else if(hp>=4 && hp<5){r=x; g=0; b=c;}
    else if(hp>=5 && hp<6){r=c; g=0; b=x;}
    let m = v-c;
    return [Math.floor((r+m)*255), Math.floor((g+m)*255), Math.floor((b+m)*255)];
}

// Draw Julia
function drawJulia(){
    hueOffset += 0.5;
    let w = offCanvas.width;
    let h = offCanvas.height;
    for(let py=0; py<h; py++){
        for(let px=0; px<w; px++){
            let x0 = (px - w/2)/(0.5*zoom*w) + offsetX;
            let y0 = (py - h/2)/(0.5*zoom*h) + offsetY;
            let iter = julia(x0, y0);
            let color = iter === maxIter ? [0,0,0] : hsvToRgb((iter*5+hueOffset)%360,1,1);
            let idx = (py*w + px)*4;
            data[idx] = color[0];
            data[idx+1] = color[1];
            data[idx+2] = color[2];
            data[idx+3] = 255;
        }
    }
    offCtx.putImageData(imageData,0,0);
    // Draw low-res canvas scaled to full screen
    ctx.drawImage(offCanvas,0,0,W,H);
}

// Animation loop
function loop(){
    drawJulia();
    zoom *= zoomFactor;
    requestAnimationFrame(loop);
}
loop();

// Resize
window.addEventListener('resize', ()=>{
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
    offCanvas.width = Math.floor(W/2);
    offCanvas.height = Math.floor(H/2);
    imageData = offCtx.createImageData(offCanvas.width, offCanvas.height);
    data = imageData.data;
});
</script>
</body>
</html>
